<!DOCTYPE html>
<html lang="en">
    <head>
        <style>
            table, td, th {  
              border: 1px solid #ddd;
              text-align: left;
            }
            
            table {
              border-collapse: collapse;
              width: 100%;
            }
            
            th, td {
              padding: 15px;
            }
            </style>
        <title>JavaScript - read JSON from URL</title>
            <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
        </head>
<body>
    <h2 class="month" >สรุปการใช้งานเครื่องยืมร่มประจำเดือน </h2>
    <!-- <button type="button" onclick="myFunction()">Click Me!</button> -->
    <div>
        <h4>บริการยืมร่ม ทั้งหมด  <b class="demo"></b> ครั้ง</h4><br>
        <Script>
                            $.getJSON('https://umbrellashareserver.herokuapp.com/month', function(data) {
                    $('.demo').append(data.length);
                });
        </Script>
        <table class="table1" style="border-collapse: collapse;">
            <tr>
                <th>ลำดับ</th>
                <th>รหัสผู้ยืม</th>
                <th>รหัสร่ม</th>
                <th>สถานที่ยืม</th>
                <th>วันที่ยืม</th>
                <th>สถานที่คืน</th>
                <th>วันที่คืน</th>
            </tr>
            <script>
                $.getJSON('https://umbrellashareserver.herokuapp.com/month', function(data) {
                    const thai_month = ['มกราคม','กุมภาพันธุ์','มีนาคม','เมษายน','พฤษภาคม','มิถุนายน','กรกฏาคม','สิงหาคม','กันยายน','ตุลาคม','พฤศจิกายน','ธันวาคม',];
                    const b_m = new Date(parseInt(data[1].borrow_time));
                    const currentMonth = b_m.getMonth(); 
                    $('.month').append(thai_month[currentMonth]);

                    var tr = data.report
                    for (var i = 0; i < data.length; i++) {
                        const b_day = new Date(parseInt(data[i].borrow_time));
                        b_day.toDateString();
                        const g_day = new Date(parseInt(data[i].getting_time));
                        g_day.toDateString();
                        tr = $('<tr/>');
                        tr.append("<td>"+(i+1)+"</td>");
                        tr.append("<td>"+data[i].user_id+"</td>");
                        tr.append("<td>"+data[i].umbrella_id+"</td>");
                        tr.append("<td>"+data[i].borrow_place+"</td>");
                        tr.append("<td>"+b_day.toLocaleDateString()+"</td>");
                        tr.append("<td>"+data[i].getting_place+"</td>");
                        tr.append("<td>"+g_day.toLocaleDateString()+"</td>");
                        $('.table1').append(tr);
                    }
                });
            </script>
        </table>
    </div>
</body>
</html>